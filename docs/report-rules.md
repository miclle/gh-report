# 报告业务规则

## 今日工作

"今日工作"展示用户**当天**参与的工作活动，以当天零点为分界。

### Pull Request

| 状态 | 是否纳入 | 说明 |
|------|----------|------|
| open / draft | 是 | 进行中的工作，始终展示 |
| 当天合并 | 是 | 今天完成的工作 |
| 当天关闭 | 是 | 今天关闭的工作 |
| 之前已合并或已关闭 | 否 | 不属于今天的工作 |

- 仅展示用户作为作者的 PR
- 有 Assignees 但不包含当前用户的 PR 不展示

### Issue

| 状态 | 是否纳入 | 说明 |
|------|----------|------|
| open | 是 | 进行中的工作，始终展示 |
| 当天创建 | 是 | 今天新建的工作 |
| 当天关闭 | 是 | 今天完成的工作 |
| 之前已关闭 | 否 | 不属于今天的工作 |

- 仅展示用户创建的 Issue
- 有 Assignees 但不包含当前用户的 Issue 不展示

### 评论

- 仅展示**当天**发表的评论
- 用户在**自己 PR/Issue** 上的评论不单独列出（已作为 PR/Issue 条目体现）
- 仅展示在**他人 PR/Issue** 上的评论，视为参与讨论或 Code Review
- 同一个 Issue 或 PR 的多条评论合并为一条记录

### Review

- 仅展示**当天**发表的 Review 评论
- 用户在**自己 PR** 上的 Review 不单独列出
- 仅展示对**他人 PR** 的 Review，视为 Code Review 活动
- 同一个 PR 的多条 Review 合并为一条记录

## 明日计划

"明日计划"展示用户接下来需要推进的工作，不按日期过滤。

### 来源 1：未完成的 PR

- 用户作为作者的 open 或 draft 状态 PR
- 已合并或已关闭的 PR 不纳入
- 有 Assignees 但不包含当前用户的 PR 不纳入

### 来源 2：当前迭代项目

- 属于**当前迭代**的项目 Item（迭代周期包含今天）
- Assignees 包含当前用户
- 状态不是 Done、Closed 或 Merged
- 如果某条 Item 已作为未完成 PR 出现，则合并展示并补充项目状态信息

### 去重

两个来源按 `仓库#编号` 去重，同一条目不会重复出现。

## 数据获取范围

`days` 参数控制从 GitHub 拉取多远的数据（默认 1 天）。该参数影响数据获取量，但不影响"今日工作"的展示范围——今日工作始终只展示当天的活动。`days` 较大时，可以为"明日计划"提供更完整的项目迭代上下文。

## 用户过滤

指定 `--user` 时，报告仅包含该用户相关的活动：

| 数据类型 | 过滤条件 |
|----------|----------|
| PR | 用户是作者 |
| Issue | 用户是创建者，且 Assignees 包含用户（或无 Assignees） |
| 评论 | 用户是评论者 |
| Review | 用户是 Review 者 |
| 明日计划（项目） | Assignees 包含用户 |

未指定 `--user` 时，展示所有用户的活动。

## 状态展示映射

### PR 状态

| 原始状态 | 展示文本 |
|----------|----------|
| merged | 已合并 |
| open + 有 Review | 已提交(审查中) |
| open + 无 Review | 已提交 |
| draft | 草稿 |
| closed | 已关闭 |

### Issue 状态

| 原始状态 | 展示文本 |
|----------|----------|
| open | 进行中 |
| closed | 已关闭 |

## 明日计划格式

- 不包含任何状态或优先级标识（如 Testing、开发中、Todo、P0、P1 等）
- 仅展示任务标题和链接
